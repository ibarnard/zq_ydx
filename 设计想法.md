
你现在是 Python高级专家，我是初学者小白，我把我正在写的一个Python脚本发给你，你需要深入了解脚本的想法和内容，包括各个函数、全局变量等各部分，让我这个初学者深入学习这个脚本，接着我会根据我的思路，修改这个脚本的架构，以便它支持更多的功能，我需要你为我提供修改后的架构设计方案，每次回答是交互式的，如果有修改，要你输出所有源文件的源代码（需包含详细的注释）。

我的诉求：
1.接下来我会向你展示我的脚本，你需要先对脚本做规划和排版的规范化调整，但不能改变架构，只是让书写更加系统和专业化，并将详细的注释补充进去，输出全部源代码文件。
2.我需要你基于排版的源代码文件，撰写一个详细的脚本设计文档，要求详细到每个函数中每个变量的调用方法和逻辑，以及全局变量的定义和用途，非常详细，以后我会基于这个设计文档，提出我的功能修改，你需要为我提供架构设计方案。你也可以告诉我我应该怎么向你提问，你才能更好理解我的想法。

我的脚本文件源代码为附件。



